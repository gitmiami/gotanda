<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="ja">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
	<title></title>
	
<script language="JavaScript">
// テキストエリア
var field = document.getElementById('textarea');


// =============================================
// 選択テキストをタグで囲む、またはキャレット位置に空のまま挿入する
// =============================================

// 挿入する開始タグと終了タグ
var tag = new Array('<b>', '</b>');

document.getElementById('button').addEventListener('click', function() {

  // 選択テキストの開始インデックス（キャレット位置）
  var start = field.selectionStart;

  // 選択テキストの終了位置
  var end = field.selectionEnd;

  // 選択テキストの長さ
  var selected = end - start;

  // 選択テキスト
  var target = selected ? field.value.substr(start, selected) : '';

  // 選択中のテキストを '<b>' で囲む
  field.value = field.value.substr(0, start) + tag[0] + target + tag[1] + field.value.substr(end, field.value.length);

  // '<b>?</b>'の部分を選択状態にする
  field.focus();
  field.setSelectionRange(start, (start + tag[0].length + selected + tag[1].length) );
});


	
</script>

</head>
<body>


<p>
<textarea id="textarea">&lt;p&gt;あのイーハトーヴォの
すきとおった風、
夏でも底に冷たさをもつ青いそら、
うつくしい森で飾られたモーリオ市、
郊外のぎらぎらひかる草の波。&lt;/p&gt;</textarea>
</p>
<p>
<input id="button" type="button" value="&lt;b&gt;">
<label><input id="checkbox" type="checkbox" value="1"> 改行を&lt;br&gt;タグに変換</label>
</p>



</body>
</html>