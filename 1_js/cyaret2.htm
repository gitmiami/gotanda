<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="ja">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
	<title></title>
</head>


<script language="JavaScript">

function f()
{
	var elem = document.getElementById( "my_input" );
	d.innerHTML = getCaretPositionIE( elem );
}

// 要素内のキャレット位置を取得する関数
function getCaretPositionIE( elem )
{
	elem.focus();

	// ボックスの先頭からキャレットまでのrangeを作って，長さを調査
	var range = document.selection.createRange();
	range.moveStart( "character", - elem.value.length );
	var caret_position = range.text.length;

	return caret_position;
}


</script>



<body>


<input type="text" size=30 id="my_input" value="hogefuga">
<input type="button" onclick="f()" value="キャレットの位置を取得">
<!-- カーソルの位置が，常にここにモニタされます。 -->
<div id="d"></div>

</body>
</html>