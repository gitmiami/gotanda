---------------module 6 -----------------


Sub sss(direc As String)

    Dim currentDir As String
    Dim saveFileName As String

    curentDir = direc
    
    Dim fs, folder, files, child, dirs
    Set fs = CreateObject("Script.fileSystemObject")
    Set folder = fs.GetFolder(curentDir)



End Sub

Sub シートでまわす()

Dim cnt As Long
Dim rg As Range

Dim motoSheet As Worksheet
Dim sakiSheet As Worksheet

Set motoSheet = ActiveWorkbook.Worksheets("moto")
Set sakiSheet = ActiveWorkbook.Worksheets("saki")

cnt = 1

For Each rg In motoSheet.Range("a1:a10")
    sakiSheet.Range("A" & cnt) = rg.vlaue
    cnt = cnt + 1
Next
    

End Sub

Sub syukei()

    Dim sakirng As Range
    syukeiDir = thisbook.Path & "集計"
    Set sakirng = Range("a1")
    ChDrive syukeiDir
    ChDir syukeiDir
    manyBook = Dir(syukeiDir & "*.xls")
    
    Do While manyBook <> ""
        Set motoBook = Workbooks.Open(manyBook)
        manyBook.Sheets(1).Range("a1:a12").Copy
        
        motoBook.Close
        monybook = Dir
        
        
        Set toprange = ""
        
        toprange.PasteSpecial.xlPasteValues
        
        
        
    Loop
  
End Sub


Sub 行挿入25()

'    Range("1:50").Insert
    Dim strR As String
    
    Dim k As Long
    Dim addGyo As Long
    
    k = ActiveCell.Row
    
    addGyo = k + 25
    
    strR = k & ":" & addGyo
    Debug.Print strR
    
    ActiveSheet.Rows(strR).Select
    
    Selection.Insert Shift:=xlDown

End Sub

Sub 文字と数値()
    Dim s As String
    s = Selection.Address
    
    Set sakirng = ActiveSheet.Range(Selection.Address)
    
    With Range(s)
        .NumberFormatLocal = "G/標準"
        .Value = Value
    End With
    
End Sub

Sub Listaddess()

    For i = 1 To 10
        Cells(i, 1).Value = Cells(i, 1).Address
    Next i
  '$A$2 $A$3
End Sub

Sub Listaddess2()
    
    For i = 1 To 10
        Range("A" & CStr(i)).Value = Range("A" & CStr(i)).Address()
    Next i
    '$A$2 $A$3

End Sub

---------------module 7 -----------------

Sub 小文字へ()
 
 '宿題　シートでまわす
 
  For i = 10 To 200
    
    Cells(i, 3) = LCase(Cells(i, 3))
    Cells(i, 9) = LCase(Cells(i, 9))
   
   
  Next i
  
   '幅
    Range("B:B").ColumnWidth = 31
   
 
End Sub
Sub 小文字へ2()
 
 '宿題　シートでまわす
 
  For i = 1 To 200
    
    Cells(i, 2) = LCase(Cells(i, 2))
    
  Next i
    
   Set font1 = Range("B1:b100").Font
    font1.Size = 10
    font1.Name = "MS 明朝"
 
End Sub

Sub macro6()
    Dim myRange As Range
    Dim keyWord1 As String, keyWord2 As String
    Dim bool As Boolean
     
    Set myRange = Range("B2:B5")
    keyWord1 = "エンジニア"
    keyWord2 = "engineer"
    bool = myRange.Replace(keyWord1, keyWord2, LookAt:=xlWhole)
End Sub

Sub macro8()
    Dim myRange As Range
    Dim keyWord1 As String, keyWord2 As String
    Dim bool As Boolean
     
    Set myRange = Range("B2:B5")
    keyWord1 = "侍*" 'ワイルドカードを使用
    keyWord2 = "Samurai"
    bool = myRange.Replace(keyWord1, keyWord2, LookAt:=xlWhole)
End Sub


'複数の条件を指定する

Sub macro9()
   'Dictionaryオブジェクトの宣言
    Dim myDic As Object
    Set myDic = CreateObject("Scripting.Dictionary")
    
    'Dictionaryオブジェクトの初期化、要素の追加
    myDic.Add "侍", "Samurai"
    myDic.Add "エンジニア", "Engineer"
    
    'Dictionaryオブジェクトを使った複数条件の置換
    Dim bool As Boolean, myRange As Range
    Set myRange = Range("B2:B5")
    For Each Var In myDic
        bool = myRange.Replace(Var, myDic(Var), LookAt:=xlPart)
    Next Var
End Sub

'★★★★★★★★★
Sub カラム比較()
    Dim hida As Long
    Dim migi As Long
    Dim cnt As Integer
    cnt = 1
    noCnt = 1
    For hida = 1 To 70
        For migi = 1 To 70
            
            If Range("A" & hida).Value = Range("B" & migi).Value Then
                Range("C" & migi).Value = cnt
                
                Exit For
            End If
            
        Next
       
       cnt = cnt + 1
    
    Next
    
    For hida = 1 To 70
        If Range("C" & hida).Value = "" Then
            Range("C" & hida).Interior.Color = vbYellow
        Else
            Range("C" & hida).Interior.Color = xlNone
        End If
    Next
End Sub
'★★★★★★★★★
Sub sort1()

    Range("A1:B100") _
              .Sort Key1:=Range("B1"), order1:=xlAscending

End Sub

Sub 空白セルレコード削除()
 Range("A1").CurrentRegion.SpecialCells(xlCellTypeBlanks).EntireRow.Delete
 
 
End Sub

Sub 空白行を削除する()
 
  Dim row_end As Long
  Dim msg As String
  Dim i As Long


  row_end = Cells.SpecialCells(xlCellTypeLastCell).Row

  For i = row_end To 1 Step -1
    If WorksheetFunction.CountA(Rows(i)) = 0 Then
      Rows(i).Delete
    End If
  Next i

End Sub
'★★★★★★★★★
Sub 逆並べ替え()
    Dim hida As Long
    Dim migi As Long
    Dim cnt As Integer
    cnt = 1
    
    
    For hida = 75 To 1 Step -1
        
        Debug.Print Range("A" & hida).Value
        
        Range("C" & cnt).Value = Range("A" & hida).Value
                
        cnt = cnt + 1
        
    Next
    
End Sub


---------------module 8 -----------------




Sub m3()

    

    Workbooks("C:\Users\asato\Desktop\サポート_1\HeartCoreテーブル定義書(V10.0.4)_CXMv1.5.6_Oracle_v4.xlsx").Sheets("100").Copy After:=Workbooks("C:\Users\asato\Desktop\サポート_1\HeartCoreテーブル定義書(V10.0.4)_oracle_v4.xlsx").Sheets("qs_index")



End Sub

Sub SheetCopyTest2()

    Application.ScreenUpdating = False


    Dim wbActive    As Workbook '// アクティブブック用
    Dim wbOpen1      As Workbook '// コピー先ブック用
    Dim wbOpen2      As Workbook '// コピー先ブック用
        
        Dim fCnt As Long
        
    Dim ws As Worksheet

'Set ws = Sheets(Sheets.Count)         ' 最後のシートを取得
'Set ws = Worksheets(Worksheets.Count) ' 最後のシートを取得
'Debug.Print (ws.Name)


    '// アクティブブックを保持
    'Set wbActive = ActiveWorkbook
    
    '// ブックを開く
    Set wbOpen1 = Workbooks.Open("C:\Users\asato\Desktop\サポート_1\moto.xlsx")
    Set wbOpen2 = Workbooks.Open("C:\Users\asato\Desktop\サポート_1\saki.xlsx")
    
    'MsgBox Worksheets(Worksheets(Worksheets.Count).Name).Select
    
    '// 開いたブックの一番左のシートの右にコピー ok
    '/////////////////////////ok
   ' Call wbOpen1.Sheets(1).Copy(After:=wbOpen2.Worksheets("qs_index"))
    
    '//////////後ろから///////////////ok
'    For fCnt = 149 To 80 Step -1
'
'       Call wbOpen1.Sheets(fCnt).Copy(After:=wbOpen2.Worksheets("qs_index"))
'
'    Next fCnt
      
    ''////NGNGNG//////はじめから
    For fCnt = 80 To 149 Step -1

        Debug.Print wbOpen1.Worksheets(fCnt).Name

        wbOpen1.Worksheets(fCnt).Copy After:=wbOpen2.Worksheets(Worksheets.Count)

    Next fCnt
        
       
      
    
    'ng   Call wbOpen1.Sheets(1).Copy(After:=wbOpen2.Worksheets(Worksheets.Count))
    Application.ScreenUpdating = True
End Sub






Sub SheetCopyTest4()
    Application.ScreenUpdating = False

  Dim 名前 As Range
  
  Dim wbOpen1      As Workbook '// コピー先ブック用
  Dim wbOpen2      As Workbook '// コピー先ブック用
    
    '// ブックを開く
    Set wbOpen1 = Workbooks.Open("C:\Users\asato\Desktop\サポート_1\moto.xlsx")
    Set wbOpen2 = Workbooks.Open("C:\Users\asato\Desktop\サポート_1\saki.xlsx")
    
    'リストシートにシート名書く
    
  For Each 名前 In wbOpen1.Worksheets("リスト").Range("A2：A5")
     
     wbOpen1.Worksheets("config").Copy After:=wbOpen2.Worksheets(Worksheets.Count)
     
      ActiveSheet.Name = 名前.Value
          
   Next 名前
   
End Sub


Sub SheetCopyTest5()

  Dim wbOpen1      As Workbook '// コピー先ブック用
  Dim wbOpen2      As Workbook '// コピー先ブック用
   
    Set wbOpen2 = Workbooks.Open("C:\Users\asato\Desktop\サポート_1\saki.xlsx")
    
    
    Set ws1 = wbOpen2.Sheets(Sheets.Count)         ' 最後のシートを取得
    Set ws2 = Worksheets(Worksheets.Count) ' 最後のシートを取得
    Debug.Print "111   "; (ws1.Name)
    Debug.Print "222   "; (ws2.Name)

End Sub

Sub sample_eb072_01()
    Dim i   As Integer

    For i = 1 To Worksheets.Count
        Debug.Print "シート名：" & Worksheets(i).Name
    Next i
End Sub

Sub sample_eb072_02()
    Dim lastShtName     As String

    lastShtName = Worksheets(Worksheets.Count).Name
    Debug.Print "最後尾シート名：" & lastShtName
End Sub





